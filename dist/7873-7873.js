/*! For license information please see 7873-7873.js.LICENSE.txt */
"use strict";(self.webpackChunknextcloud=self.webpackChunknextcloud||[]).push([[7873],{41252:function(e,t,r){r.d(t,{Z:function(){return h}});var i=r(29727),s=r(4996),n=r(86768),o=r(51474),c=r(4263),l=r(78255);const a={name:"NcTextField",components:{NcInputField:i.Z,Close:s.Z,ArrowRight:n.Z,Undo:o.Z},inheritAttrs:!1,props:{...i.Z.props,trailingButtonIcon:{type:String,default:"close",validator:e=>["close","arrowRight","undo"].includes(e)}},emits:["update:value"],computed:{clearTextLabel(){return this.trailingButtonLabel||(0,c.t)("Clear text")}},methods:{focus(){this.$refs.inputField.focus()},select(){this.$refs.inputField.select()},handleInput(e){this.$emit("update:value",e.target.value)}}};var u=function(){var e=this,t=e._self._c;return t("NcInputField",e._g(e._b({ref:"inputField",attrs:{"trailing-button-label":e.clearTextLabel},on:{input:e.handleInput},scopedSlots:e._u(["search"!==e.type?{key:"trailing-button-icon",fn:function(){return["close"===e.trailingButtonIcon?t("Close",{attrs:{size:20}}):"arrowRight"===e.trailingButtonIcon?t("ArrowRight",{attrs:{size:20}}):"undo"===e.trailingButtonIcon?t("Undo",{attrs:{size:20}}):e._e()]},proxy:!0}:null],null,!0)},"NcInputField",{...e.$attrs,...e.$props},!1),e.$listeners),[e._t("default")],2)},d=[];const h=(0,l.n)(a,u,d,!1,null,null,null,null).exports},24957:function(e,t,r){r(83033);var i=r(27498);i.YM.themes.tooltip.html=!1,i.YM.themes.tooltip.delay={show:500,hide:200},i.YM.themes.tooltip.distance=10,i.YM.themes.tooltip["arrow-padding"]=3},84859:function(e,t,r){r.d(t,{N:function(){return S},j:function(){return le},n:function(){return B}}),r(29169);var i=r(78255),s=r(4263),n=r(78505),o=r(96422),c=r(58217),l=r(29341),a=r(29526),u=r(12989),d=r(26873),h=r(35633),p=r(41252),m=r(47149),v=r(11045),f=r(15282),_=r(88205),y=r(4360),b=r(4996),g=r(20144),w=r(25108);window._vue_richtext_widgets||(window._vue_richtext_widgets={}),window._registerWidget=(e,t,r=(e=>{}))=>{window._vue_richtext_widgets[e]?w.error("Widget for id "+e+" already registered"):window._vue_richtext_widgets[e]={id:e,callback:t,onDestroy:r}};const k={name:"NcReferenceWidget",props:{reference:{type:Object,required:!0}},data(){return{compact:3}},computed:{hasCustomWidget(){return e=this.reference.richObjectType,!!window._vue_richtext_widgets[e];var e},noAccess(){return this.reference&&!this.reference.accessible},descriptionStyle(){if(0===this.compact)return{display:"none"};const e=this.compact<4?this.compact:3;return{lineClamp:e,webkitLineClamp:e}},compactLink(){const e=this.reference.openGraphObject.link;return e?e.startsWith("https://")?e.substring(8):e.startsWith("http://")?e.substring(7):e:""}},mounted(){this.renderWidget(),this.observer=new ResizeObserver((e=>{e[0].contentRect.width<450?this.compact=0:e[0].contentRect.width<550?this.compact=1:e[0].contentRect.width<650?this.compact=2:this.compact=3})),this.observer.observe(this.$el)},beforeDestroy(){var e,t;this.observer.disconnect(),e=this.reference.richObjectType,t=this.$el,"open-graph"!==e&&window._vue_richtext_widgets[e]&&window._vue_richtext_widgets[e].onDestroy(t)},methods:{renderWidget(){var e;this.$refs.customWidget&&(this.$refs.customWidget.innerHTML=""),"open-graph"!==(null==(e=null==this?void 0:this.reference)?void 0:e.richObjectType)&&this.$nextTick((()=>{((e,{richObjectType:t,richObject:r,accessible:i})=>{if("open-graph"!==t){if(!window._vue_richtext_widgets[t])return void w.error("Widget for rich object type "+t+" not registered");window._vue_richtext_widgets[t].callback(e,{richObjectType:t,richObject:r,accessible:i})}})(this.$refs.customWidget,this.reference)}))}}};var P=function(){var e=this,t=e._self._c;return t("div",[e.reference&&e.hasCustomWidget?t("div",{staticClass:"widget-custom"},[t("div",{ref:"customWidget"})]):!e.noAccess&&e.reference&&e.reference.openGraphObject&&!e.hasCustomWidget?t("a",{staticClass:"widget-default",attrs:{href:e.reference.openGraphObject.link,rel:"noopener noreferrer",target:"_blank"}},[e.reference.openGraphObject.thumb?t("img",{staticClass:"widget-default--image",attrs:{src:e.reference.openGraphObject.thumb}}):e._e(),t("div",{staticClass:"widget-default--details"},[t("p",{staticClass:"widget-default--name"},[e._v(e._s(e.reference.openGraphObject.name))]),t("p",{staticClass:"widget-default--description",style:e.descriptionStyle},[e._v(e._s(e.reference.openGraphObject.description))]),t("p",{staticClass:"widget-default--link"},[e._v(e._s(e.compactLink))])])]):e._e()])},C=[];const S=(0,i.n)(k,P,C,!1,null,"b1c5a80f",null,null).exports;window._vue_richtext_custom_picker_elements||(window._vue_richtext_custom_picker_elements={});const I=e=>!!window._vue_richtext_custom_picker_elements[e];window._registerCustomPickerElement=(e,t,r=(e=>{}),i="large")=>{window._vue_richtext_custom_picker_elements[e]?w.error("Custom reference picker element for id "+e+" already registered"):window._vue_richtext_custom_picker_elements[e]={id:e,callback:t,onDestroy:r,size:i}};const x={name:"NcCustomPickerElement",props:{provider:{type:Object,required:!0}},emits:["cancel","submit"],data(){return{isRegistered:I(this.provider.id),renderResult:null}},mounted(){this.isRegistered&&this.renderElement()},beforeDestroy(){var e,t,r;this.isRegistered&&(e=this.provider.id,t=this.$el,r=this.renderResult,window._vue_richtext_custom_picker_elements[e]&&window._vue_richtext_custom_picker_elements[e].onDestroy(t,r))},methods:{renderElement(){this.$refs.domElement&&(this.$refs.domElement.innerHTML="");const e=((e,{providerId:t,accessible:r})=>{if(window._vue_richtext_custom_picker_elements[t])return window._vue_richtext_custom_picker_elements[t].callback(e,{providerId:t,accessible:r});w.error("Custom reference picker element for reference provider ID "+t+" not registered")})(this.$refs.domElement,{providerId:this.provider.id,accessible:!1});Promise.resolve(e).then((e=>{var t,r;this.renderResult=e,null!=(t=this.renderResult.object)&&t._isVue&&null!=(r=this.renderResult.object)&&r.$on&&(this.renderResult.object.$on("submit",this.onSubmit),this.renderResult.object.$on("cancel",this.onCancel)),this.renderResult.element.addEventListener("submit",(e=>{this.onSubmit(e.detail)})),this.renderResult.element.addEventListener("cancel",this.onCancel)}))},onSubmit(e){this.$emit("submit",e)},onCancel(){this.$emit("cancel")}}};var R=function(){return(0,this._self._c)("div",{ref:"domElement"})},L=[];const N=(0,i.n)(x,R,L,!1,null,"cf695ff9",null,null).exports,$="any-link",E={id:$,title:(0,s.t)("Any link"),icon_url:(0,c.hp)("core","filetypes/link.svg")};function O(){return window._vue_richtext_reference_providers.filter((e=>{const t=!!e.search_providers_ids&&e.search_providers_ids.length>0||I(e.id);return t||w.debug("[smart picker]",e.id,"reference provider is discoverable but does not have any related search provider or custom picker component registered"),t}))}function B(e,t=null){const r=O(),i=e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),s=new RegExp(i,"i"),n=function(e){const t=window._vue_richtext_reference_provider_timestamps;return e.sort(((e,t)=>e.order===t.order?0:e.order>t.order?1:-1)).sort(((e,r)=>{const i=t[e.id],s=t[r.id];return i===s?0:void 0===s?-1:void 0===i?1:i>s?-1:1}))}(r).filter((e=>e.title.match(s))),o=t?n.slice(0,t):n;return(""===e||0===o.length)&&o.push(E),o}window._vue_richtext_reference_providers||(window._vue_richtext_reference_providers=(0,o.j)("core","reference-provider-list",[])),window._vue_richtext_reference_provider_timestamps||(window._vue_richtext_reference_provider_timestamps=(0,o.j)("core","reference-provider-timestamps",{}));let T=0;function j(e,t){return function(){const r=this,i=arguments;clearTimeout(T),T=setTimeout((function(){e.apply(r,i)}),t||0)}}function M(e){try{return!!new URL(e)}catch{return!1}}const q={name:"NcProviderList",components:{NcSelect:u.Z,NcHighlight:a.N,NcEmptyContent:l.Z,LinkVariantIcon:d.Z},emits:["select-provider","submit"],data(){return{selectedProvider:null,query:"",multiselectPlaceholder:(0,s.t)("Select provider"),providerIconAlt:(0,s.t)("Provider icon")}},computed:{options(){const e=[];return""!==this.query&&M(this.query)&&e.push({id:this.query,title:this.query,isLink:!0}),e.push(...B(this.query)),e}},methods:{focus(){setTimeout((()=>{var e,t,r;null==(r=null==(t=null==(e=this.$refs["provider-select"])?void 0:e.$el)?void 0:t.querySelector("#provider-select-input"))||r.focus()}),300)},onProviderSelected(e){null!==e&&(e.isLink?this.$emit("submit",e.title):this.$emit("select-provider",e),this.selectedProvider=null)},onSearch(e,t){this.query=e}}};var V=function(){var e=this,t=e._self._c;return t("div",{staticClass:"provider-list"},[t("NcSelect",{ref:"provider-select",staticClass:"provider-list--select",attrs:{"input-id":"provider-select-input",label:"title",placeholder:e.multiselectPlaceholder,options:e.options,"append-to-body":!1,"clear-search-on-select":!0,"clear-search-on-blur":()=>!1,filterable:!1},on:{search:e.onSearch,input:e.onProviderSelected},scopedSlots:e._u([{key:"option",fn:function(r){return[r.isLink?t("div",{staticClass:"provider"},[t("LinkVariantIcon",{staticClass:"link-icon",attrs:{size:20}}),t("span",[e._v(e._s(r.title))])],1):t("div",{staticClass:"provider"},[t("img",{staticClass:"provider-icon",attrs:{src:r.icon_url,alt:e.providerIconAlt}}),t("NcHighlight",{staticClass:"option-text",attrs:{search:e.query,text:r.title}})],1)]}}]),model:{value:e.selectedProvider,callback:function(t){e.selectedProvider=t},expression:"selectedProvider"}}),t("NcEmptyContent",{staticClass:"provider-list--empty-content",scopedSlots:e._u([{key:"icon",fn:function(){return[t("LinkVariantIcon")]},proxy:!0}])})],1)},Z=[];const D=(0,i.n)(q,V,Z,!1,null,"9d850ea5",null,null).exports,W={name:"NcRawLinkInput",components:{LinkVariantIcon:d.Z,NcEmptyContent:l.Z,NcLoadingIcon:h.Z,NcReferenceWidget:S,NcTextField:p.Z},props:{provider:{type:Object,required:!0}},emits:["submit"],data(){return{inputValue:"",loading:!1,reference:null,abortController:null,inputPlaceholder:(0,s.t)("Enter link")}},computed:{isLinkValid(){return M(this.inputValue)}},methods:{focus(){var e;null==(e=this.$refs["url-input"].$el.getElementsByTagName("input")[0])||e.focus()},onSubmit(e){const t=e.target.value;this.isLinkValid&&this.$emit("submit",t)},onClear(){this.inputValue="",this.reference=null},onInput(){this.reference=null,this.abortController&&this.abortController.abort(),this.isLinkValid&&j((()=>{this.updateReference()}),500)()},updateReference(){this.loading=!0,this.abortController=new AbortController,n.Z.get((0,c.Ii)("references/resolve",2)+"?reference="+encodeURIComponent(this.inputValue),{signal:this.abortController.signal}).then((e=>{this.reference=e.data.ocs.data.references[this.inputValue]})).catch((e=>{w.error(e)})).then((()=>{this.loading=!1}))}}};var z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"raw-link"},[t("div",{staticClass:"input-wrapper"},[t("NcTextField",{ref:"url-input",attrs:{value:e.inputValue,"show-trailing-button":""!==e.inputValue,label:e.inputPlaceholder},on:{"update:value":[function(t){e.inputValue=t},e.onInput],"trailing-button-click":e.onClear},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit.apply(null,arguments)}}},[e.loading?t("NcLoadingIcon",{attrs:{size:16}}):t("LinkVariantIcon",{attrs:{size:16}})],1)],1),null!==e.reference?t("NcReferenceWidget",{staticClass:"reference-widget",attrs:{reference:e.reference}}):t("NcEmptyContent",{staticClass:"raw-link--empty-content",scopedSlots:e._u([{key:"icon",fn:function(){return[e.provider.icon_url?t("img",{staticClass:"provider-icon",attrs:{src:e.provider.icon_url}}):t("LinkVariantIcon")]},proxy:!0}])})],1)},A=[];const U=(0,i.n)(W,z,A,!1,null,"d0ba247a",null,null).exports,F={name:"NcSearchResult",components:{NcHighlight:a.N},props:{entry:{type:Object,required:!0},query:{type:String,required:!0}}};var G=function(){var e=this,t=e._self._c;return t("div",{staticClass:"result"},[e.entry.icon?t("div",{staticClass:"result--icon-class",class:{[e.entry.icon]:!0,rounded:e.entry.rounded}}):t("img",{staticClass:"result--image",class:{rounded:e.entry.rounded},attrs:{src:e.entry.thumbnailUrl}}),t("div",{staticClass:"result--content"},[t("span",{staticClass:"result--content--name"},[t("NcHighlight",{attrs:{search:e.query,text:e.entry.title}})],1),t("span",{staticClass:"result--content--subline"},[t("NcHighlight",{attrs:{search:e.query,text:e.entry.subline}})],1)])])},H=[];const Q=(0,i.n)(F,G,H,!1,null,"7a394a58",null,null).exports,Y={name:"NcSearch",components:{LinkVariantIcon:d.Z,DotsHorizontalIcon:m.Z,NcEmptyContent:l.Z,NcSelect:u.Z,NcSearchResult:Q},props:{provider:{type:Object,required:!0},showEmptyContent:{type:Boolean,default:!0},searchPlaceholder:{type:String,default:null}},emits:["submit"],data(){return{searchQuery:"",selectedResult:null,resultsBySearchProvider:{},searching:!1,searchingMoreOf:null,abortController:null,noOptionsText:(0,s.t)("Start typing to search"),providerIconAlt:(0,s.t)("Provider icon")}},computed:{mySearchPlaceholder(){return this.searchPlaceholder||(0,s.t)("Search")},searchProviderIds(){return this.provider.search_providers_ids},options(){if(""===this.searchQuery)return[];const e=[];return M(this.searchQuery)&&e.push(this.rawLinkEntry),e.push(...this.formattedSearchResults),e},rawLinkEntry(){return{id:"rawLinkEntry",resourceUrl:this.searchQuery,isRawLink:!0}},formattedSearchResults(){const e=[];return this.searchProviderIds.forEach((t=>{if(this.resultsBySearchProvider[t].entries.length>0){(this.searchProviderIds.length>1||this.resultsBySearchProvider[t].entries.length>1)&&e.push({id:"groupTitle-"+t,name:this.resultsBySearchProvider[t].name,isCustomGroupTitle:!0,providerId:t});const r=this.resultsBySearchProvider[t].entries.map(((e,r)=>({id:"provider-"+t+"-entry-"+r,...e})));e.push(...r),this.resultsBySearchProvider[t].isPaginated&&e.push({id:"moreOf-"+t,name:this.resultsBySearchProvider[t].name,isMore:!0,providerId:t,isLoading:this.searchingMoreOf===t})}})),e}},mounted(){this.resetResults()},beforeDestroy(){this.cancelSearchRequests()},methods:{t:s.t,resetResults(){const e={};this.searchProviderIds.forEach((t=>{e[t]={entries:[]}})),this.resultsBySearchProvider=e},focus(){setTimeout((()=>{var e,t,r;null==(r=null==(t=null==(e=this.$refs["search-select"])?void 0:e.$el)?void 0:t.querySelector("#search-select-input"))||r.focus()}),300)},cancelSearchRequests(){this.abortController&&this.abortController.abort()},onSearchInput(e,t){this.searchQuery=e,j((()=>{this.updateSearch()}),500)()},onSelectResultSelected(e){null!==e&&(e.resourceUrl?(this.cancelSearchRequests(),this.$emit("submit",e.resourceUrl)):e.isMore&&this.searchMoreOf(e.providerId).then((()=>{this.selectedResult=null})))},searchMoreOf(e){return this.searchingMoreOf=e,this.cancelSearchRequests(),this.searchProviders(e)},updateSearch(){if(this.cancelSearchRequests(),this.resetResults(),""!==this.searchQuery)return this.searchProviders();this.searching=!1},searchProviders(e=null){var t,r;this.abortController=new AbortController,this.searching=!0;const i=null===e?[...this.searchProviderIds].map((e=>this.searchOneProvider(e))):[this.searchOneProvider(e,null!=(r=null==(t=this.resultsBySearchProvider[e])?void 0:t.cursor)?r:null)];return Promise.allSettled(i).then((e=>{e.find((e=>"rejected"===e.status&&("CanceledError"===e.reason.name||"ERR_CANCELED"===e.reason.code)))||(this.searching=!1,this.searchingMoreOf=null)}))},searchOneProvider(e,t=null){const r=null===t?(0,c.Ii)("search/providers/{providerId}/search?term={term}&limit={limit}",{providerId:e,term:this.searchQuery,limit:5}):(0,c.Ii)("search/providers/{providerId}/search?term={term}&limit={limit}&cursor={cursor}",{providerId:e,term:this.searchQuery,limit:5,cursor:t});return n.Z.get(r,{signal:this.abortController.signal}).then((t=>{const r=t.data.ocs.data;this.resultsBySearchProvider[e].name=r.name,this.resultsBySearchProvider[e].cursor=r.cursor,this.resultsBySearchProvider[e].isPaginated=r.isPaginated,this.resultsBySearchProvider[e].entries.push(...r.entries)}))}}};var J=function(){var e=this,t=e._self._c;return t("div",{staticClass:"smart-picker-search",class:{"with-empty-content":e.showEmptyContent}},[t("NcSelect",{ref:"search-select",staticClass:"smart-picker-search--select",attrs:{"input-id":"search-select-input",label:"name",placeholder:e.mySearchPlaceholder,options:e.options,"append-to-body":!1,"close-on-select":!1,"clear-search-on-select":!1,"clear-search-on-blur":()=>!1,"reset-focus-on-options-change":!1,filterable:!1,autoscroll:!0,"reset-on-options-change":!1,loading:e.searching},on:{search:e.onSearchInput,input:e.onSelectResultSelected},scopedSlots:e._u([{key:"option",fn:function(r){return[r.isRawLink?t("div",{staticClass:"custom-option"},[t("LinkVariantIcon",{staticClass:"option-simple-icon",attrs:{size:20}}),t("span",{staticClass:"option-text"},[e._v(" "+e._s(e.t("Raw link {options}",{options:r.resourceUrl}))+" ")])],1):r.resourceUrl?t("NcSearchResult",{staticClass:"search-result",attrs:{entry:r,query:e.searchQuery}}):r.isCustomGroupTitle?t("span",{staticClass:"custom-option group-name"},[e.provider.icon_url?t("img",{staticClass:"provider-icon group-name-icon",attrs:{src:e.provider.icon_url}}):e._e(),t("span",{staticClass:"option-text"},[t("strong",[e._v(e._s(r.name))])])]):r.isMore?t("span",{class:{"custom-option":!0}},[r.isLoading?t("span",{staticClass:"option-simple-icon icon-loading-small"}):t("DotsHorizontalIcon",{staticClass:"option-simple-icon",attrs:{size:20}}),t("span",{staticClass:"option-text"},[e._v(" "+e._s(e.t('Load more "{options}"',{options:r.name}))+" ")])],1):e._e()]}},{key:"no-options",fn:function(){return[e._v(" "+e._s(e.noOptionsText)+" ")]},proxy:!0}]),model:{value:e.selectedResult,callback:function(t){e.selectedResult=t},expression:"selectedResult"}}),e.showEmptyContent?t("NcEmptyContent",{staticClass:"smart-picker-search--empty-content",scopedSlots:e._u([{key:"icon",fn:function(){return[e.provider.icon_url?t("img",{staticClass:"provider-icon",attrs:{alt:e.providerIconAlt,src:e.provider.icon_url}}):t("LinkVariantIcon")]},proxy:!0}],null,!1,2922132592)}):e._e()],1)},K=[];const X=(0,i.n)(Y,J,K,!1,null,"97d196f0",null,null).exports,ee={providerList:1,standardLinkInput:2,searchInput:3,customElement:4},te={name:"NcReferencePicker",components:{NcCustomPickerElement:N,NcProviderList:D,NcRawLinkInput:U,NcSearch:X},props:{initialProvider:{type:Object,default:()=>null},width:{type:Number,default:null},focusOnCreate:{type:Boolean,default:!0}},emits:["cancel","cancel-raw-link","cancel-search","provider-selected","submit"],data(){return{MODES:ee,selectedProvider:this.initialProvider}},computed:{mode(){return null===this.selectedProvider?ee.providerList:I(this.selectedProvider.id)?ee.customElement:this.selectedProvider.search_providers_ids?ee.searchInput:ee.standardLinkInput},pickerWrapperStyle(){return{width:this.width?this.width+"px":void 0}}},mounted(){this.focusOnCreate&&(this.initialProvider?setTimeout((()=>{var e;null==(e=this.$refs["url-input"])||e.focus()}),300):this.$nextTick((()=>{var e;null==(e=this.$refs["provider-list"])||e.focus()})))},methods:{onEscapePressed(){null!==this.selectedProvider?this.deselectProvider():this.cancelProviderSelection()},onProviderSelected(e){this.selectedProvider=e,this.$emit("provider-selected",e),this.$nextTick((()=>{var e;null==(e=this.$refs["url-input"])||e.focus()}))},cancelCustomElement(){this.deselectProvider()},cancelSearch(){var e;this.$emit("cancel-search",null==(e=this.selectedProvider)?void 0:e.title),this.deselectProvider()},cancelRawLinkInput(){var e;this.$emit("cancel-raw-link",null==(e=this.selectedProvider)?void 0:e.title),this.deselectProvider()},cancelProviderSelection(){this.$emit("cancel")},submitLink(e){null!==this.selectedProvider&&function(e){const t=Math.floor(Date.now()/1e3),r={timestamp:t},i=(0,c.Ii)("references/provider/{providerId}",{providerId:e});n.Z.put(i,r).then((r=>{window._vue_richtext_reference_provider_timestamps[e]=t}))}(this.selectedProvider.id),this.$emit("submit",e),this.deselectProvider()},deselectProvider(){this.selectedProvider=null,this.$emit("provider-selected",null),setTimeout((()=>{var e;null==(e=this.$refs["provider-list"])||e.focus()}),300)}}};var re=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reference-picker",style:e.pickerWrapperStyle,attrs:{tabindex:"-1"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:(t.stopPropagation(),t.preventDefault(),e.onEscapePressed.apply(null,arguments))}}},[e.mode===e.MODES.providerList?t("NcProviderList",{ref:"provider-list",on:{"select-provider":e.onProviderSelected,submit:e.submitLink,cancel:e.cancelProviderSelection}}):e.mode===e.MODES.standardLinkInput?t("NcRawLinkInput",{ref:"url-input",attrs:{provider:e.selectedProvider},on:{submit:e.submitLink,cancel:e.cancelRawLinkInput}}):e.mode===e.MODES.searchInput?t("NcSearch",{ref:"url-input",attrs:{provider:e.selectedProvider},on:{cancel:e.cancelSearch,submit:e.submitLink}}):e.mode===e.MODES.customElement?t("div",{staticClass:"custom-element-wrapper"},[t("NcCustomPickerElement",{attrs:{provider:e.selectedProvider},on:{submit:e.submitLink,cancel:e.cancelCustomElement}})],1):e._e()],1)},ie=[];const se={name:"NcReferencePickerModal",components:{NcReferencePicker:(0,i.n)(te,re,ie,!1,null,"aa77d0d3",null,null).exports,NcModal:f.Z,NcButton:v.Z,ArrowLeftIcon:y.Z,CloseIcon:b.Z},props:{initialProvider:{type:Object,default:()=>null},focusOnCreate:{type:Boolean,default:!0},isInsideViewer:{type:Boolean,default:!1}},emits:["cancel","submit"],data(){return{show:!0,selectedProvider:this.initialProvider,backButtonTitle:(0,s.t)("Back to provider selection"),closeButtonTitle:(0,s.t)("Close"),closeButtonLabel:(0,s.t)("Close Smart Picker")}},computed:{isProviderSelected(){return null!==this.selectedProvider},showBackButton(){return null===this.initialProvider&&this.isProviderSelected},modalSize(){var e;return this.isProviderSelected&&I(this.selectedProvider.id)?null!=(e=(e=>{var t;const r=null==(t=window._vue_richtext_custom_picker_elements[e])?void 0:t.size;return["small","normal","large","full"].includes(r)?r:null})(this.selectedProvider.id))?e:"large":"normal"},showModalName(){return!this.isProviderSelected||!I(this.selectedProvider.id)},modalName(){return this.isProviderSelected?this.selectedProvider.title:(0,s.t)("Smart Picker")}},mounted(){if(this.isInsideViewer){const e=this.$refs.modal_content;(0,_.j8)("viewer:trapElements:changed",e)}},methods:{onCancel(){this.show=!1,this.$emit("cancel")},onSubmit(e){this.show=!1,this.$emit("submit",e)},onProviderSelect(e){this.selectedProvider=e,null===e&&null!==this.initialProvider&&this.onCancel()},onBackClicked(){this.$refs.referencePicker.deselectProvider()}}};var ne=function(){var e=this,t=e._self._c;return e.show?t("NcModal",{staticClass:"reference-picker-modal",attrs:{size:e.modalSize,"can-close":!1},on:{close:e.onCancel}},[t("div",{ref:"modal_content",staticClass:"reference-picker-modal--content"},[e.showBackButton?t("NcButton",{staticClass:"back-button",attrs:{"aria-label":e.backButtonTitle,title:e.backButtonTitle},on:{click:e.onBackClicked},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ArrowLeftIcon")]},proxy:!0}],null,!1,3001860362)}):e._e(),t("NcButton",{staticClass:"close-button",attrs:{"aria-label":e.closeButtonLabel,title:e.closeButtonTitle,type:"tertiary"},on:{click:e.onCancel},scopedSlots:e._u([{key:"icon",fn:function(){return[t("CloseIcon")]},proxy:!0}],null,!1,2491825086)}),e.showModalName?t("h2",[e._v(" "+e._s(e.modalName)+" ")]):e._e(),t("NcReferencePicker",{ref:"referencePicker",attrs:{"initial-provider":e.initialProvider,"focus-on-create":e.focusOnCreate},on:{"provider-selected":e.onProviderSelect,submit:e.onSubmit,cancel:e.onCancel}})],1)]):e._e()},oe=[];const ce=(0,i.n)(se,ne,oe,!1,null,"3f1a4ac7",null,null).exports;async function le(e=null,t=void 0){return await new Promise(((r,i)=>{var s;const n=document.createElement("div");n.id="referencePickerModal",document.body.append(n);const o=null===e?null:null!=(s=function(e){return e===$?E:O().find((t=>t.id===e))}(e))?s:null,c=new(g.default.extend(ce))({propsData:{initialProvider:o,isInsideViewer:t}}).$mount(n);c.$on("cancel",(()=>{c.$destroy(),i(new Error("User cancellation"))})),c.$on("submit",(e=>{c.$destroy(),r(e)}))}))}}}]);
//# sourceMappingURL=7873-7873.js.map?v=a9a4c92d571923f7e1c9